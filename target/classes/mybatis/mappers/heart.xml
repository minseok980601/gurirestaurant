<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="mapper.heart">
	<resultMap type="heartDTO" id="heartResult">
		<result property="h_no" column="h_no"/>
		<result property="gr_num" column="gr_num"/>
		<result property="id" column="id"/>	
		<result property="steamcheck" column="steamcheck"/>
	</resultMap>
	
	<select id="findHeart" parameterType="java.util.HashMap" resultType="heartDTO">
		<![CDATA[
			SELECT *
			FROM GR_HEART
			WHERE gr_num = #{gr_num} AND ID = #{kim}
		]]>
	</select>
	
	<!-- 찜 1로 만들어서 중복 방지 -->
	<update id="heartUpdateCheck">
		<![CDATA[
			UPDATE GR_HEART 
			SET steamcheck = 1
			WHERE gr_num = #{gr_num} AND id = #{id}
		]]>
	</update>
	
	<select id="heartCheck" resultType="int">
		<![CDATA[
			select count(*)
			from gr_heart
			where gr_num = #{gr_num} and id = #{id}
		]]>
	</select>
	
	<insert id="heartRestaurant" parameterType="java.util.Map">
		<![CDATA[
			INSERT INTO GR_HEART (h_no, gr_num, id)
			values((SELECT NVL(MAX(h_no), 0) + 1 FROM GR_HEART), #{gr_num}, #{id})
		]]>
	</insert>
</mapper>